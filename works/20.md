# 智慧护理系统环境部署手册

**变更记录**

| 版本号 | 变更日期   | 变更类型 | 变更人 | 变更摘要             | 备注 |
| ------ | ---------- | -------- | ------ | -------------------- | ---- |
| 1.0    | 2020-01-16 | N        | 陈齐 | 创建文档             |      |
| 1.1    | 2020-01-19 | M        | 魏佩佩 | 新增与his对接、前端维护、客户端安装部分 |      |
| 1.2    | 2020-02-05 | M        | 杨建东 | 修改 Docker 安装 |      |
| 1.3    | 2020-02-06 | M        | 杨建东 | 修改 |      |
| 1.4    | 2020-02-09 | M        | 魏佩佩 | 修改前端维护模块 |      |
| 1.5    | 2020-02-10 | M        | 杨建东 | 整理文档 |      |
| 1.6    | 2020-02-11 | M        | 杨建东 | 整理文档 |      |
| 1.7    | 2020-02-12 | M        | 杨建东 | 整理服务安装文档 | 标准化路径     |

## 说明

- 本产品系统采用微服务架构，部署时采用 Docker 虚机，对实施人员有一定要求，需掌握些简单 Linux 命令
- vi 是 Linux 系统常带的编辑工具，新手不容易掌握。建议如果要编辑文件，可以用windows 下的编辑工具如VSCode，然后通过 Xshell 上传到Linux
- 安装过程尽量做到标准化，特别是对安装路径、服务命名严格按公司约定进行
- 实施人员在操作过程中，如果有建议或者问题，及时提出，帮助本手册持续改进

## 约定

- Docker 数据存储路径统一为 `/data/docker`
- 产品安装路径统一为 `/home/eking/docker/docker-scloud`
  - `third-part`， 中间件，第三方服务
  - `eking`，基础服务
  - `busi`, 业务应用
- Linux 上载文件路径统一为 `/home/eking/soft`
  - Docker 安装包 `/home/eking/soft/docker`
  - 产品安装包 `/home/eking/soft/app`，并且按版本存放，如 `/home/eking/soft/app/v1`

>[warning] 注意：安装前为了保证安装成功，以上路径需安排公司专人进行检查

## 所需文件

安装包文件夹说明:

- docker-install, Docker 系统安装包
  - docker-18.06.1-ce.tgz
  - docker.service
  - docker-compose
- docker-image, Docker 镜像
- eking, 产品程序
- tools，工具
  - Xshell
  - MySQL 客户端

>[info] 由专人统一发布和管理安装包

## 部署方案介绍

[TODO] 标准要求见附件：智慧护理综合信息平台部署方案.docx

## 现场服务器检查

检查现场服务器硬件软件是否符合产品部署要求

### 硬件

按产品要求的硬件条件进行检查

### 软件

- 操作系统：Centos7.3
- 检查是否有所需的系统软件
  - ssh 服务，openssh-server
  - tar
  - zip, unzip

### 空间检查

为保证 Docker 使用空间，约定 Docker 数据路径 `/data/docker`，安装前需检查下 Linux 系统挂载点

>[info] 由于宿主机由第三方安装，暂时没强制规定系统挂载路径，所以安装前由专人检查下现场情况

### 配置

现场示例

| 服务器       | ip            | 操作系统  | 用户名 | 密码     |
| ------------ | ------------- | --------- | ------ | -------- |
| 应用服务器   | 192.168.1.136 | Centos7.3 | root   | 现场提供 |
| 数据库服务器 | 192.168.1.137 | Centos7.3 | root   | 现场提供 |
| 文件服务器1  | 192.168.1.138 | Centos7.3 | root   | 现场提供 |
| 文件服务器2  | 192.138.1.139 | Centos7.3 | root   | 现场提供 |

### 网络

根据服务类型开放端口，根据安装情况设定，这里暂时忽略

## 安装

安装过程是通过 ssh 到 Linux 进行操作，选用工具软件 Xshell，查看 [Xshell使用参考](/docs/zhhl/zhhl-1bqp5at6vi872/)

### 服务安装

- [Docker安装部署](/docs/zhhl/zhhl-1bqp5l68i22ft/)
- [数据库服务器安装](/docs/zhhl/zhhl-1bqp6vb3g0tkl/)
- [文件服务器安装](/docs/zhhl/zhhl-1bqp8am11u5c4/)
- [应用服务器安装](/docs/zhhl/zhhl-1bqp7g4pl4a84/)
- [与老his对接](/docs/zhhl/zhhl-1bqp8eiu4p8a9/)

### 服务维护

- 医院信息化运维管理平台[前端维护](/docs/zhhl/zhhl-1bsdbnmtlm8i1/)
  - 超级管理员新建医疗机构字典，新建分院字典，新建机构管理员，并给机构管理员赋予租户管理员权限；
  - 机构管理员初始化系统，并完成其他功能。


### 客户端安装

#### 所需文件

[TODO]

#### 约定

- 安装路径

#### 安装步骤

- 安装 `NDP462-KB3151800-x86-x64-AllOS-ENU.exe`
- 拷贝 nursing 文件夹，并放至 `D:\ekingsoft` 文件夹下
- [修改应用服务器及消息服务器地址（详见护理文书系统操作手册）](/docs/zhhl/zhhl-1bnqc0sr9mv33#71z3z3 "修改应用服务器及消息服务器地址")
- 登录系统验证是否可以正常使用
